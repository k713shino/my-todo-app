@tailwind base;
@tailwind components;
@tailwind utilities;

/* 基本的なテーマ設定 */
:root {
  --background: #ffffff;
  --foreground: #0f0f0f;
}

/* スクロール動作の最適化 - 自動スムーススクロールを無効化 */
html {
  scroll-behavior: auto !important;
}

.dark {
  --background: #0f0f0f;
  --foreground: #ededed;
}

/* 明示的なライトテーマクラス */
.light {
  --background: #ffffff;
  --foreground: #0f0f0f;
}

/* body要素の基本スタイル */
body {
  color: var(--foreground);
  background-color: var(--background);
  background-image: radial-gradient(1200px 600px at 80% -10%, rgba(124, 58, 237, 0.07), rgba(0,0,0,0)),
    radial-gradient(1000px 500px at -10% 10%, rgba(59, 130, 246, 0.06), rgba(0,0,0,0));
  background-repeat: no-repeat;
  font-family: Arial, Helvetica, sans-serif;
  transition: background-color 0.3s ease, color 0.3s ease;
  /* モバイル対応 */
  -webkit-text-size-adjust: 100%;
  -webkit-tap-highlight-color: transparent;
}

/* フォーム要素のダークモード対応 */
input,
textarea,
select {
  transition: background-color 0.2s ease, color 0.2s ease, border-color 0.2s ease;
}

/* ダークモード時のフォーム要素（システム設定を無視） */
html.dark input:not([type="submit"]):not([type="button"]),
html.dark textarea,
html.dark select {
  background-color: #1f2937 !important;
  color: #f9fafb !important;
  border-color: #374151 !important;
}

html.dark input:not([type="submit"]):not([type="button"]):focus,
html.dark textarea:focus,
html.dark select:focus {
  border-color: #8b5cf6 !important;
  outline: 2px solid #8b5cf6 !important;
  outline-offset: 2px;
}

html.dark input::placeholder,
html.dark textarea::placeholder {
  color: #9ca3af !important;
}

/* ライトモード時のフォーム要素も明示 */
html.light input:not([type="submit"]):not([type="button"]),
html.light textarea,
html.light select {
  background-color: #ffffff !important;
  color: #000000 !important;
  border-color: #d1d5db !important;
}

/* スクロールバーのダークモード対応（システム設定を無視） */
html.dark::-webkit-scrollbar {
  width: 8px;
}

html.dark::-webkit-scrollbar-track {
  background: #1f2937 !important;
}

html.dark::-webkit-scrollbar-thumb {
  background: #4b5563 !important;
  border-radius: 4px;
}

html.dark::-webkit-scrollbar-thumb:hover {
  background: #6b7280 !important;
}

/* システム設定の影響を制限しつつ、デザインを保持 */
@media (prefers-color-scheme: dark) {
  html:not(.dark):not(.light) {
    /* システムテーマ時のみシステム設定を適用 */
    --background: #0f0f0f;
    --foreground: #ededed;
  }
}

@media (prefers-color-scheme: light) {
  html:not(.dark):not(.light) {
    /* システムテーマ時のみシステム設定を適用 */
    --background: #ffffff;
    --foreground: #0f0f0f;
  }
}

/* 再利用できるUIユーティリティ */
@layer components {
  .app-container {
    @apply max-w-7xl mx-auto px-3 sm:px-6 lg:px-8;
  }
  .card {
    @apply bg-white dark:bg-gray-800 rounded-xl shadow-sm border border-gray-200 dark:border-gray-700;
  }
  .card-soft {
    @apply bg-white/80 dark:bg-gray-800/80 backdrop-blur rounded-xl shadow-sm border border-gray-200/80 dark:border-gray-700/80;
  }
  .card-section {
    @apply p-4 sm:p-6;
  }
  .section-title {
    @apply text-lg font-semibold text-gray-900 dark:text-gray-100;
  }
  .muted {
    @apply text-gray-500 dark:text-gray-400;
  }
  .btn-primary {
    @apply inline-flex items-center justify-center px-3 py-2 rounded-md bg-purple-600 text-white hover:bg-purple-700 active:bg-purple-800 focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-purple-500 disabled:opacity-50 disabled:cursor-not-allowed transition-colors;
  }
  .btn-ghost {
    @apply inline-flex items-center justify-center px-3 py-2 rounded-md text-gray-700 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700 focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-gray-400 transition-colors;
  }
  .input-base {
    @apply w-full px-3 py-2 rounded-md border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-700 text-gray-900 dark:text-gray-100 placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-purple-500;
  }
  .select-base {
    @apply px-2 py-1 rounded-md border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-700 text-gray-700 dark:text-gray-200 focus:outline-none focus:ring-2 focus:ring-purple-500;
  }
  .toolbar {
    @apply flex items-center gap-2 p-2 rounded-lg bg-gray-50 dark:bg-gray-800 border border-gray-200 dark:border-gray-700;
  }
  .kpi {
    @apply rounded-lg p-4 border shadow-sm;
  }
  /* モバイル安全領域（ノッチ等）対応 */
  .safe-top {
    padding-top: env(safe-area-inset-top);
  }
  .safe-bottom {
    padding-bottom: env(safe-area-inset-bottom);
  }
  /* タップターゲット最小サイズ（iOS/Android推奨 >=44px） */
  .tap-target {
    min-height: 44px;
  }
}
